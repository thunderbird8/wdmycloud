/*

 jQuery Tools @VERSION / Expose - Dim the lights

 NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.

 http://flowplayer.org/tools/toolbox/expose.html

 Since: Mar 2010
 Date: @DATE
*/
(function(b){function f(){if(b.browser.msie){var a=b(document).height(),c=b(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,20>a-c?c:a]}return[b(document).width(),b(document).height()]}function h(a){if(a)return a.call(b.mask)}b.tools=b.tools||{version:"@VERSION"};var m;m=b.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"none",closeOnClick:!0,closeOnEsc:!0,zIndex:9998,opacity:.8,startOpacity:0,color:"#fff",onLoad:null,
onClose:null}};var c,k,l,e;b.mask={load:function(a,g){if(l)return this;"string"==typeof a&&(a={color:a});a=a||e;e=a=b.extend(b.extend({},m.conf),a);var d=Math.max.apply(null,b.map(b("body > *"),function(c,d){if(1E4<parseInt(b(c).css("z-index"),10))b(c).remove();else{if(b(c).hasClass("Tooltip"))return!0;if("absolute"==b(c).css("position"))return parseInt(b(c).css("z-index"),10)||a.zIndex}}));isNaN(parseInt(d,10))&&(d=a.zIndex);a.zIndex=d;c=b(".exposeMask");0<c.length&&(a.maskId=a.maskId+"_"+(new Date).getTime());
c=b("#"+a.maskId);c.length||(c=b("<div/>").attr("id",a.maskId),c.addClass("exposeMask"),b("body").append(c));d=f();c.css({position:"absolute",top:0,left:0,width:d[0],height:d[1],display:"none",opacity:a.startOpacity,zIndex:a.zIndex});a.color&&c.css("backgroundColor",a.color);if(!1===h(a.onBeforeLoad))return this;if(a.closeOnEsc)b(document).on("keydown.mask",function(a){27==a.keyCode&&b.mask.close(a)});if(a.closeOnClick)c.on("click.mask",function(a){b.mask.close(a)});b(window).on("resize.mask",function(){b.mask.fit()});
g&&g.length&&(d=g.eq(0).css("zIndex"),b.each(g,function(){var a=b(this);/relative|absolute|fixed/i.test(a.css("position"))||a.css("position","relative")}),k=g.css({zIndex:Math.max(a.zIndex+1,"auto"==d?0:d)}));c.css({display:"block"}).fadeTo(a.loadSpeed,a.opacity,function(){b.mask.fit();h(a.onLoad)});return this},close:function(){var a="",c=-1,d=-1,f=0;b(".exposeMask").each(function(){var a=parseInt(b(this).css("zIndex"),10);a>c&&!b(this).hasClass("remove")&&(c=a,d=f);f++});-1<d&&(a=b(".exposeMask").eq(d),
a.addClass("remove"));if(0<a.length){if(!1===h(e.onBeforeClose))return this;a.fadeOut(e.closeSpeed,function(){h(e.onClose);k&&k.css({zIndex:void 0});l=!1;a.remove()});b(document).off("keydown.mask");a.off("click.mask");b(window).off("resize.mask")}return this},fit:function(){var a=f();c.css({width:a[0],height:a[1]})},getMask:function(){return c},isLoaded:function(a){return a?"full"==l:l},getConf:function(){return e},getExposed:function(){return k}};b.fn.mask=function(a){b.mask.load(a);return this};
b.fn.expose=function(a){b.mask.load(a,this);return this}})(jQuery);